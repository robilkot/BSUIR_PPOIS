# Лабораторная работа 3

## Описание приложения

Asteroids - копия оригинальной игры Atari, разработанная на Python с использованием библиотеки pygame.
Игрок управляет космическим кораблем, проникающим через пояс астероидов, уничтожая их и летающие тарелки, избегая столкновений и обстрела.
Игра требует быстрых реакций и точности в управлении, чтобы успешно миновать окончания.

## Демонстрация работы

### Главное окно приложения

![image](https://github.com/robilkot/BSUIR_PPOIS/assets/82116328/f36c617d-a491-47bf-b9cb-cbf418801271)

Главное меню предлагает пользователю начать игру, посмотреть справку по игре, посмотреть таблицу рекордов либо же выйти.

### Справка

![image](https://github.com/robilkot/BSUIR_PPOIS/assets/82116328/aad2497f-3b73-4077-b583-bee5d2d50230)

Окно справки рассказывает легенду игры, а также об управлении.

### Таблица рекордов

![image](https://github.com/robilkot/BSUIR_PPOIS/assets/82116328/4e7cb08a-8963-4575-9862-d0caee489bd6)

В таблице рекордов отражены последние 5 лучших игр. При наборе рекордного количества очков по окончании игры игрока просят ввести имя для сохранения в таблице.

![image](https://github.com/robilkot/BSUIR_PPOIS/assets/82116328/39ac4eab-42b6-4ec9-a860-824746a58bd1)

### Геймплей

![image](https://github.com/robilkot/BSUIR_PPOIS/assets/82116328/1b233f94-bc8b-4bc1-926d-bf974c19bd41)

Во время геймплея интерфейс отображает количество жизней (спрайты космического корабля слева сверху), количество очков (справа сверху), а также сообщения о примененных модификаторах игры сверху в центре.

## Архитектура приложения

### Общие характеристики

В приложении используется библиотека pygame, в частности для отображения графики и для создания звуковых эффектов.
Приложение разработано с использованием паттерна MVC с активной моделью.

![image](https://github.com/robilkot/BSUIR_PPOIS/assets/82116328/b529d3f3-4482-443e-bf4b-f283ff7a981f)

На слое model содержатся все игровые сущности и непосредственно модель игры со всей бизнес-логикой.
Controller отвечает за связь уровней и пользователя. Там обрабатываются события ввода.
View отвечает строго за отрисовку при поступлении event'ов с других слоев.

Для удобства коммуникации между слоями реализован класс EventBus, представляющий собой реализацию паттерна event bus.

Приложение как совокупность интерфейса и непосредственно игры представляет из собой стековую машину состояний по аналогии с теми, что используются в мобильных UI-фреймворках.
За этот функционал отвечает класс StateMachine.

### Игра

Игра представляет из себя обработку логики над энтити. Для представления последних создан класс BaseEntity с методами draw, move и полями для задания спрайтов.
От BaseEntity унаследованы Asteroid, Spaceship, Ufo, Bullet и иные классы объектов. Все они могут быть отрисованы и логически обработаны при помощи единого api за счет общего класса-предка.
Астероиды обладают массой и количеством очков, которое выдается за их уничтожение. Масса же используется для расчётов столкновений объектов.

Основная логика рассчитывается в классе GameModel в методе _process_logic. При этом расчёты физики столкновений вынесены в отдельный файл physics. Аналогично сделано со вспомогательными функциями по типу функции wrap'инга положения объектов на игровом поле.
Некоторые энтити обладают возможностью крушения/разрушения. Для объединения их в общий интерфейс создан класс Crashable с методом crash. Он позволяет одинаково обращаться к летающим тарелкам и астероидам в случае обработки коллизий.
Эти объекты по разному обрабатывают столкновения: так, астероиды полиморфно делятся на более мелкие, а летающая тарелка при крушении лишь издаёт специфический звук.

Часть логики, выполняемой после крушения объектов, передается из класса GameModel с помощью callback функций. Таким образом обеспечивается слабое зацепление классов: энтити не знают о классе GameModel, при этом способны при своем уничтожении удалять себя
из списка объектов в объекте последнего класса.

Визуальная часть игры представлена спрайтами. Они хранятся в папке assets, как и аудио-файлы для звуковых эффектов и фоновой музыки.
